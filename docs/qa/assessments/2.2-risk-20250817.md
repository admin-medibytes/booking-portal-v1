# Risk Profile: Story 2.2

Date: 2025-08-17
Reviewer: Quinn (Test Architect)

## Executive Summary

- Total Risks Identified: 16
- Critical Risks: 2
- High Risks: 3
- Risk Score: 20/100 (High Risk)

## Critical Risks Requiring Immediate Attention

### 1. SEC-001: PII Exposure via Client-Side State Persistence

**Score: 9 (Critical)**
**Probability**: High - Form state persisted in sessionStorage/URL contains sensitive examinee data
**Impact**: High - PII exposure if device is shared or URL is shared/logged
**Mitigation**:
- Encrypt sensitive data before storing in sessionStorage
- Avoid storing PII in URL parameters
- Implement secure session timeout
- Clear storage on logout/session end
**Testing Focus**: Security testing for data exposure in browser storage and URLs

### 2. DATA-001: Race Condition in Booking Creation

**Score: 9 (Critical)**  
**Probability**: High - Multiple users could book same slot simultaneously
**Impact**: High - Double bookings causing business disruption and poor user experience
**Mitigation**:
- Implement optimistic locking in booking creation
- Add database transaction with slot availability check
- Use Redis distributed lock during booking creation
- Implement proper conflict resolution UI
**Testing Focus**: Concurrent booking scenarios, load testing with simultaneous requests

## Risk Distribution

### By Category
- Security: 4 risks (1 critical)
- Performance: 3 risks (0 critical)
- Data: 3 risks (1 critical)
- Technical: 3 risks (0 critical)
- Business: 2 risks (0 critical)
- Operational: 1 risk (0 critical)

### By Component
- Frontend: 7 risks
- Backend: 6 risks
- Database: 2 risks
- Infrastructure: 1 risk

## Detailed Risk Register

| Risk ID | Description | Probability | Impact | Score | Priority |
|---------|-------------|-------------|---------|--------|----------|
| SEC-001 | PII exposure via client-side persistence | High (3) | High (3) | 9 | Critical |
| DATA-001 | Race condition in booking creation | High (3) | High (3) | 9 | Critical |
| SEC-002 | XSS via unsanitized form inputs | Medium (2) | High (3) | 6 | High |
| PERF-001 | Availability API response time >3s under load | Medium (2) | High (3) | 6 | High |
| DATA-002 | Form data loss on navigation/refresh | High (3) | Medium (2) | 6 | High |
| TECH-001 | Multi-step form state management complexity | Medium (2) | Medium (2) | 4 | Medium |
| SEC-003 | Missing rate limiting on booking creation | Medium (2) | Medium (2) | 4 | Medium |
| PERF-002 | Timezone conversion performance with large datasets | Medium (2) | Medium (2) | 4 | Medium |
| BUS-001 | Poor UX causing booking abandonment | Medium (2) | Medium (2) | 4 | Medium |
| TECH-002 | ArkType validation schema maintenance | Low (1) | Medium (2) | 2 | Low |
| SEC-004 | Insufficient input length validation | Low (1) | Medium (2) | 2 | Low |
| PERF-003 | Redis cache miss causing slow response | Low (1) | Medium (2) | 2 | Low |
| DATA-003 | Incorrect timezone handling edge cases | Low (1) | Medium (2) | 2 | Low |
| BUS-002 | Feature doesn't meet 3-minute completion target | Low (1) | Medium (2) | 2 | Low |
| TECH-003 | TanStack Form version compatibility | Low (1) | Low (1) | 1 | Minimal |
| OPS-001 | Incomplete error tracking setup | Low (1) | Low (1) | 1 | Minimal |

## Risk-Based Testing Strategy

### Priority 1: Critical Risk Tests
- **Concurrent Booking Tests**: Simulate 50+ simultaneous bookings for same slot
- **Security Penetration Tests**: Test for PII exposure in browser storage
- **XSS Attack Vectors**: Test all form inputs with malicious payloads
- **Race Condition Tests**: Use JMeter to create booking race conditions

### Priority 2: High Risk Tests
- **Load Tests**: Verify <3s response time with 100 concurrent users
- **Form Persistence Tests**: Test data recovery after browser crashes
- **API Rate Limiting**: Verify booking submission rate limits work
- **Timezone Edge Cases**: Test DST transitions, UTC boundaries

### Priority 3: Medium/Low Risk Tests
- **Form Validation Tests**: Comprehensive input validation coverage
- **Cache Performance**: Test Redis cache hit/miss scenarios
- **UX Flow Tests**: Measure actual booking completion times
- **Error Handling**: Verify all error states show proper messages

## Risk Acceptance Criteria

### Must Fix Before Production
- All critical risks (score 9)
- SEC-002: XSS vulnerabilities in forms
- Implement distributed locking for bookings

### Can Deploy with Mitigation
- PERF-001: If monitoring and scaling plan in place
- DATA-002: If form persistence is reliable 90%+ of time
- Medium risks with proper error handling

### Accepted Risks
- TECH-003: Framework compatibility (monitor for updates)
- OPS-001: Basic error tracking sufficient for MVP

## Monitoring Requirements

Post-deployment monitoring for:
- **Booking Success Rate**: Track failed vs successful bookings
- **Double Booking Incidents**: Alert on any slot conflicts  
- **API Response Times**: 95th percentile < 3 seconds
- **Form Abandonment Rate**: Track multi-step completion
- **Security Events**: Monitor for XSS attempts and suspicious patterns
- **Cache Hit Ratio**: Maintain >80% Redis cache hits

## Risk Review Triggers

Review and update risk profile when:
- User load exceeds 100 concurrent bookings
- Adding new form fields or validation rules
- Integrating additional third-party services
- Security vulnerabilities reported in dependencies
- Performance degradation observed in production